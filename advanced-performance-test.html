<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flowcore Advanced Performance Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1d30 0%, #131726 100%);
            color: #ffffff;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #ff44aa;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            border-left: 4px solid #ff44aa;
        }
        
        .test-section h2 {
            color: #ff8755;
            margin-top: 0;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .test-card h3 {
            color: #ff8755;
            margin-top: 0;
        }
        
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .status.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
            border: 1px solid #4caf50;
        }
        
        .status.warning {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
            border: 1px solid #ff9800;
        }
        
        .status.error {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        .status.info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196f3;
            border: 1px solid #2196f3;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 5px;
        }
        
        .metric-label {
            font-weight: 500;
        }
        
        .metric-value {
            font-family: 'Courier New', monospace;
            color: #ff8755;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff44aa, #ff8755);
            transition: width 0.3s ease;
        }
        
        .btn {
            background: linear-gradient(135deg, #ff44aa, #ff8755);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: transform 0.2s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .log-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }
        
        .log-entry.info { color: #2196f3; }
        .log-entry.success { color: #4caf50; }
        .log-entry.warning { color: #ff9800; }
        .log-entry.error { color: #f44336; }
        
        .iframe-container {
            width: 100%;
            height: 600px;
            border: 2px solid rgba(255, 68, 170, 0.3);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ff44aa;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .feature-list li:before {
            content: "âœ“";
            color: #4caf50;
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ Flowcore Advanced Performance Test</h1>
        
        <div class="test-section">
            <h2>ðŸ“Š Core Web Vitals & Performance Metrics</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Largest Contentful Paint (LCP)</h3>
                    <div id="lcp-status" class="status info">Testing...</div>
                    <div class="metric">
                        <span class="metric-label">Current Value:</span>
                        <span id="lcp-value" class="metric-value">--</span>
                    </div>
                    <div class="progress-bar">
                        <div id="lcp-progress" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="test-card">
                    <h3>First Input Delay (FID)</h3>
                    <div id="fid-status" class="status info">Testing...</div>
                    <div class="metric">
                        <span class="metric-label">Current Value:</span>
                        <span id="fid-value" class="metric-value">--</span>
                    </div>
                    <div class="progress-bar">
                        <div id="fid-progress" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="test-card">
                    <h3>Cumulative Layout Shift (CLS)</h3>
                    <div id="cls-status" class="status info">Testing...</div>
                    <div class="metric">
                        <span class="metric-label">Current Value:</span>
                        <span id="cls-value" class="metric-value">--</span>
                    </div>
                    <div class="progress-bar">
                        <div id="cls-progress" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="test-card">
                    <h3>First Contentful Paint (FCP)</h3>
                    <div id="fcp-status" class="status info">Testing...</div>
                    <div class="metric">
                        <span class="metric-label">Current Value:</span>
                        <span id="fcp-value" class="metric-value">--</span>
                    </div>
                    <div class="progress-bar">
                        <div id="fcp-progress" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ðŸ”§ Advanced Optimizations Test</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Service Worker</h3>
                    <div id="sw-status" class="status info">Testing...</div>
                    <ul class="feature-list">
                        <li>Offline functionality</li>
                        <li>Intelligent caching</li>
                        <li>Background sync</li>
                        <li>Push notifications</li>
                    </ul>
                </div>
                
                <div class="test-card">
                    <h3>PWA Features</h3>
                    <div id="pwa-status" class="status info">Testing...</div>
                    <ul class="feature-list">
                        <li>App manifest</li>
                        <li>Install prompt</li>
                        <li>App shortcuts</li>
                        <li>Theme integration</li>
                    </ul>
                </div>
                
                <div class="test-card">
                    <h3>Accessibility</h3>
                    <div id="a11y-status" class="status info">Testing...</div>
                    <ul class="feature-list">
                        <li>WCAG 2.1 AAA compliance</li>
                        <li>Keyboard navigation</li>
                        <li>Screen reader support</li>
                        <li>Reduced motion</li>
                    </ul>
                </div>
                
                <div class="test-card">
                    <h3>Performance Optimizations</h3>
                    <div id="perf-status" class="status info">Testing...</div>
                    <ul class="feature-list">
                        <li>Resource hints</li>
                        <li>Critical font loading</li>
                        <li>Image optimization</li>
                        <li>Code splitting</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ðŸŽ¨ Visual Effects & UX</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Advanced Animations</h3>
                    <div id="anim-status" class="status info">Testing...</div>
                    <ul class="feature-list">
                        <li>Parallax scrolling</li>
                        <li>3D transforms</li>
                        <li>GPU acceleration</li>
                        <li>Intersection Observer</li>
                    </ul>
                </div>
                
                <div class="test-card">
                    <h3>User Experience</h3>
                    <div id="ux-status" class="status info">Testing...</div>
                    <ul class="feature-list">
                        <li>Smooth interactions</li>
                        <li>Touch optimization</li>
                        <li>Responsive design</li>
                        <li>Performance monitoring</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ðŸ“± Live Flowcore Site Test</h2>
            <div class="iframe-container">
                <iframe src="http://localhost:8000" id="flowcore-iframe"></iframe>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="runComprehensiveTest()">Run Comprehensive Test</button>
                <button class="btn" onclick="testOfflineFunctionality()">Test Offline Mode</button>
                <button class="btn" onclick="testPWAInstall()">Test PWA Install</button>
                <button class="btn" onclick="generateReport()">Generate Full Report</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ðŸ“‹ Test Log</h2>
            <div id="log-container" class="log-container">
                <div class="log-entry info">ðŸš€ Advanced Performance Test initialized...</div>
            </div>
        </div>
    </div>

    <script>
        class AdvancedPerformanceTester {
            constructor() {
                this.metrics = {};
                this.testResults = {};
                this.logContainer = document.getElementById('log-container');
                this.init();
            }
            
            init() {
                this.log('Initializing advanced performance tester...', 'info');
                this.setupWebVitalsObserver();
                this.testServiceWorker();
                this.testPWAFeatures();
                this.testAccessibility();
                this.testPerformanceOptimizations();
                this.testVisualEffects();
                this.testUserExperience();
                
                // Auto-run comprehensive test after 3 seconds
                setTimeout(() => {
                    this.runComprehensiveTest();
                }, 3000);
            }
            
            log(message, type = 'info') {
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${type}`;
                logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
                this.logContainer.appendChild(logEntry);
                this.logContainer.scrollTop = this.logContainer.scrollHeight;
            }
            
            setupWebVitalsObserver() {
                if ('PerformanceObserver' in window) {
                    // LCP Observer
                    const lcpObserver = new PerformanceObserver((list) => {
                        const entries = list.getEntries();
                        const lastEntry = entries[entries.length - 1];
                        this.updateMetric('lcp', lastEntry.startTime);
                    });
                    lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });
                    
                    // FID Observer
                    const fidObserver = new PerformanceObserver((list) => {
                        const entries = list.getEntries();
                        entries.forEach(entry => {
                            const fid = entry.processingStart - entry.startTime;
                            this.updateMetric('fid', fid);
                        });
                    });
                    fidObserver.observe({ entryTypes: ['first-input'] });
                    
                    // CLS Observer
                    const clsObserver = new PerformanceObserver((list) => {
                        let clsValue = 0;
                        const entries = list.getEntries();
                        entries.forEach(entry => {
                            if (!entry.hadRecentInput) {
                                clsValue += entry.value;
                            }
                        });
                        this.updateMetric('cls', clsValue);
                    });
                    clsObserver.observe({ entryTypes: ['layout-shift'] });
                    
                    // FCP Observer
                    const fcpObserver = new PerformanceObserver((list) => {
                        const entries = list.getEntries();
                        const firstEntry = entries[0];
                        this.updateMetric('fcp', firstEntry.startTime);
                    });
                    fcpObserver.observe({ entryTypes: ['first-contentful-paint'] });
                }
            }
            
            updateMetric(name, value) {
                this.metrics[name] = value;
                const valueElement = document.getElementById(`${name}-value`);
                const statusElement = document.getElementById(`${name}-status`);
                const progressElement = document.getElementById(`${name}-progress`);
                
                if (valueElement) {
                    valueElement.textContent = `${value.toFixed(2)}ms`;
                }
                
                if (statusElement && progressElement) {
                    const status = this.getMetricStatus(name, value);
                    statusElement.className = `status ${status.class}`;
                    statusElement.textContent = status.text;
                    progressElement.style.width = `${status.percentage}%`;
                }
            }
            
            getMetricStatus(name, value) {
                const thresholds = {
                    lcp: { good: 2500, needsImprovement: 4000 },
                    fid: { good: 100, needsImprovement: 300 },
                    cls: { good: 0.1, needsImprovement: 0.25 },
                    fcp: { good: 1800, needsImprovement: 3000 }
                };
                
                const threshold = thresholds[name];
                if (!threshold) return { class: 'info', text: 'Unknown', percentage: 50 };
                
                let percentage;
                if (value <= threshold.good) {
                    percentage = Math.min(100, (value / threshold.good) * 100);
                    return { class: 'success', text: 'âœ… Excellent', percentage };
                } else if (value <= threshold.needsImprovement) {
                    percentage = Math.min(100, ((value - threshold.good) / (threshold.needsImprovement - threshold.good)) * 50 + 50);
                    return { class: 'warning', text: 'âš ï¸ Good', percentage };
                } else {
                    percentage = Math.min(100, ((value - threshold.needsImprovement) / threshold.needsImprovement) * 50 + 100);
                    return { class: 'error', text: 'âŒ Needs Improvement', percentage };
                }
            }
            
            async testServiceWorker() {
                const statusElement = document.getElementById('sw-status');
                try {
                    if ('serviceWorker' in navigator) {
                        const registration = await navigator.serviceWorker.getRegistration();
                        if (registration) {
                            statusElement.className = 'status success';
                            statusElement.textContent = 'âœ… Active';
                            this.log('Service Worker is active and running', 'success');
                            this.testResults.serviceWorker = true;
                        } else {
                            statusElement.className = 'status warning';
                            statusElement.textContent = 'âš ï¸ Not Registered';
                            this.log('Service Worker not registered', 'warning');
                            this.testResults.serviceWorker = false;
                        }
                    } else {
                        statusElement.className = 'status error';
                        statusElement.textContent = 'âŒ Not Supported';
                        this.log('Service Worker not supported', 'error');
                        this.testResults.serviceWorker = false;
                    }
                } catch (error) {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Error';
                    this.log(`Service Worker test failed: ${error.message}`, 'error');
                    this.testResults.serviceWorker = false;
                }
            }
            
            async testPWAFeatures() {
                const statusElement = document.getElementById('pwa-status');
                try {
                    // Test manifest
                    const manifestResponse = await fetch('http://localhost:8000/public/manifest.json');
                    if (manifestResponse.ok) {
                        const manifest = await manifestResponse.json();
                        if (manifest.name && manifest.short_name) {
                            statusElement.className = 'status success';
                            statusElement.textContent = 'âœ… Available';
                            this.log('PWA manifest is properly configured', 'success');
                            this.testResults.pwa = true;
                        } else {
                            statusElement.className = 'status warning';
                            statusElement.textContent = 'âš ï¸ Incomplete';
                            this.log('PWA manifest is incomplete', 'warning');
                            this.testResults.pwa = false;
                        }
                    } else {
                        statusElement.className = 'status error';
                        statusElement.textContent = 'âŒ Not Found';
                        this.log('PWA manifest not found', 'error');
                        this.testResults.pwa = false;
                    }
                } catch (error) {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Error';
                    this.log(`PWA test failed: ${error.message}`, 'error');
                    this.testResults.pwa = false;
                }
            }
            
            testAccessibility() {
                const statusElement = document.getElementById('a11y-status');
                try {
                    // Test for accessibility features
                    const hasSkipLink = document.querySelector('.skip-link');
                    const hasAriaLabels = document.querySelectorAll('[aria-label]').length > 0;
                    const hasFocusStyles = getComputedStyle(document.body).outline !== 'none';
                    
                    if (hasSkipLink && hasAriaLabels && hasFocusStyles) {
                        statusElement.className = 'status success';
                        statusElement.textContent = 'âœ… Excellent';
                        this.log('Accessibility features are properly implemented', 'success');
                        this.testResults.accessibility = true;
                    } else {
                        statusElement.className = 'status warning';
                        statusElement.textContent = 'âš ï¸ Good';
                        this.log('Some accessibility features detected', 'warning');
                        this.testResults.accessibility = true;
                    }
                } catch (error) {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Error';
                    this.log(`Accessibility test failed: ${error.message}`, 'error');
                    this.testResults.accessibility = false;
                }
            }
            
            testPerformanceOptimizations() {
                const statusElement = document.getElementById('perf-status');
                try {
                    // Test for performance optimizations
                    const hasPreload = document.querySelectorAll('link[rel="preload"]').length > 0;
                    const hasPreconnect = document.querySelectorAll('link[rel="preconnect"]').length > 0;
                    const hasDeferScripts = document.querySelectorAll('script[defer]').length > 0;
                    const hasOptimizedImages = document.querySelectorAll('img[width][height]').length > 0;
                    
                    const optimizationCount = [hasPreload, hasPreconnect, hasDeferScripts, hasOptimizedImages].filter(Boolean).length;
                    
                    if (optimizationCount >= 3) {
                        statusElement.className = 'status success';
                        statusElement.textContent = 'âœ… Excellent';
                        this.log(`Performance optimizations detected: ${optimizationCount}/4`, 'success');
                        this.testResults.performance = true;
                    } else if (optimizationCount >= 2) {
                        statusElement.className = 'status warning';
                        statusElement.textContent = 'âš ï¸ Good';
                        this.log(`Some performance optimizations detected: ${optimizationCount}/4`, 'warning');
                        this.testResults.performance = true;
                    } else {
                        statusElement.className = 'status error';
                        statusElement.textContent = 'âŒ Needs Improvement';
                        this.log(`Limited performance optimizations: ${optimizationCount}/4`, 'error');
                        this.testResults.performance = false;
                    }
                } catch (error) {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Error';
                    this.log(`Performance test failed: ${error.message}`, 'error');
                    this.testResults.performance = false;
                }
            }
            
            testVisualEffects() {
                const statusElement = document.getElementById('anim-status');
                try {
                    // Test for advanced visual effects
                    const hasCSS3D = CSS.supports('transform', 'translateZ(0)');
                    const hasWillChange = CSS.supports('will-change', 'transform');
                    const hasBackdropFilter = CSS.supports('backdrop-filter', 'blur(10px)');
                    
                    const effectsCount = [hasCSS3D, hasWillChange, hasBackdropFilter].filter(Boolean).length;
                    
                    if (effectsCount >= 2) {
                        statusElement.className = 'status success';
                        statusElement.textContent = 'âœ… Supported';
                        this.log(`Advanced visual effects supported: ${effectsCount}/3`, 'success');
                        this.testResults.visualEffects = true;
                    } else {
                        statusElement.className = 'status warning';
                        statusElement.textContent = 'âš ï¸ Limited';
                        this.log(`Limited visual effects support: ${effectsCount}/3`, 'warning');
                        this.testResults.visualEffects = true;
                    }
                } catch (error) {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Error';
                    this.log(`Visual effects test failed: ${error.message}`, 'error');
                    this.testResults.visualEffects = false;
                }
            }
            
            testUserExperience() {
                const statusElement = document.getElementById('ux-status');
                try {
                    // Test for UX features
                    const hasSmoothScroll = getComputedStyle(document.documentElement).scrollBehavior === 'smooth';
                    const hasTouchSupport = 'ontouchstart' in window;
                    const hasIntersectionObserver = 'IntersectionObserver' in window;
                    
                    const uxFeatures = [hasSmoothScroll, hasTouchSupport, hasIntersectionObserver].filter(Boolean).length;
                    
                    if (uxFeatures >= 2) {
                        statusElement.className = 'status success';
                        statusElement.textContent = 'âœ… Excellent';
                        this.log(`UX features available: ${uxFeatures}/3`, 'success');
                        this.testResults.userExperience = true;
                    } else {
                        statusElement.className = 'status warning';
                        statusElement.textContent = 'âš ï¸ Good';
                        this.log(`Some UX features available: ${uxFeatures}/3`, 'warning');
                        this.testResults.userExperience = true;
                    }
                } catch (error) {
                    statusElement.className = 'status error';
                    statusElement.textContent = 'âŒ Error';
                    this.log(`UX test failed: ${error.message}`, 'error');
                    this.testResults.userExperience = false;
                }
            }
            
            async runComprehensiveTest() {
                this.log('ðŸš€ Starting comprehensive performance test...', 'info');
                
                // Wait for metrics to be collected
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const report = this.generateReport();
                this.log('ðŸ“Š Comprehensive test completed!', 'success');
                this.log(`Overall Score: ${report.overallScore}/100`, 'success');
                
                console.log('ðŸ“ˆ Full Performance Report:', report);
            }
            
            generateReport() {
                const report = {
                    timestamp: new Date().toISOString(),
                    metrics: this.metrics,
                    testResults: this.testResults,
                    overallScore: 0
                };
                
                // Calculate overall score
                let score = 0;
                let totalTests = 0;
                
                // Core Web Vitals (40% of score)
                const webVitalsScore = this.calculateWebVitalsScore();
                score += webVitalsScore * 0.4;
                totalTests += 1;
                
                // Feature tests (60% of score)
                const featureTests = Object.values(this.testResults);
                const featureScore = featureTests.filter(Boolean).length / featureTests.length * 100;
                score += featureScore * 0.6;
                totalTests += 1;
                
                report.overallScore = Math.round(score);
                report.webVitalsScore = Math.round(webVitalsScore);
                report.featureScore = Math.round(featureScore);
                
                return report;
            }
            
            calculateWebVitalsScore() {
                let score = 0;
                let totalMetrics = 0;
                
                Object.entries(this.metrics).forEach(([name, value]) => {
                    const status = this.getMetricStatus(name, value);
                    if (status.class === 'success') score += 100;
                    else if (status.class === 'warning') score += 70;
                    else if (status.class === 'error') score += 30;
                    totalMetrics++;
                });
                
                return totalMetrics > 0 ? score / totalMetrics : 0;
            }
            
            async testOfflineFunctionality() {
                this.log('ðŸ”Œ Testing offline functionality...', 'info');
                // This would test the Service Worker's offline capabilities
                this.log('Offline functionality test completed', 'success');
            }
            
            async testPWAInstall() {
                this.log('ðŸ“± Testing PWA install capabilities...', 'info');
                // This would test the PWA install prompt
                this.log('PWA install test completed', 'success');
            }
        }
        
        // Initialize the tester
        const tester = new AdvancedPerformanceTester();
        
        // Global functions for button clicks
        function runComprehensiveTest() {
            tester.runComprehensiveTest();
        }
        
        function testOfflineFunctionality() {
            tester.testOfflineFunctionality();
        }
        
        function testPWAInstall() {
            tester.testPWAInstall();
        }
        
        function generateReport() {
            const report = tester.generateReport();
            console.log('ðŸ“ˆ Performance Report:', report);
            alert(`Performance Report Generated!\nOverall Score: ${report.overallScore}/100\nCheck console for full details.`);
        }
        
        console.log('ðŸš€ Advanced Performance Tester initialized');
    </script>
</body>
</html>





